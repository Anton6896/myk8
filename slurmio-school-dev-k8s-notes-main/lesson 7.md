# –£—Ä–æ–∫ 7: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∞.

[–£—Ä–æ–∫ 7: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∞. –í–µ—á–µ—Ä–Ω—è—è —à–∫–æ–ª–∞ Kubernetes](https://youtu.be/0rN_tUIZx7Y)

# [Agenda –ª–µ–∫—Ü–∏–∏](https://youtu.be/0rN_tUIZx7Y?t=87)

- –ò–∑ —á–µ–≥–æ —Å–æ—Å—Ç–æ–∏—Ç –∫–ª–∞—Å—Ç–µ—Ä
- –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤—Å–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
    - –ï—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∏ –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—Å—ë –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–æ–∫–µ—Ä, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –ø—Ä–æ—á–∞—è.
    - –ß–µ–≥–æ –º–æ–∂–Ω–æ –æ–∂–∏–¥–∞—Ç—å –æ—Ç k8s –∏ —á–µ–≥–æ –æ–∂–∏–¥–∞—Ç—å –Ω–µ —Å—Ç–æ–∏—Ç
    - –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, —Ç–æ –ø–æ –∫–∞–∫–∏–º –ø—Ä–∏—á–∏–Ω–∞–º —ç—Ç–æ –º–æ–≥–ª–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏

# [–ü–ª–∞–Ω](https://youtu.be/0rN_tUIZx7Y?t=146)

–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞, –±–µ–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. –ò —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ - —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä k8s –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- Etcd
- API server
- Controller-manager
- Scheduler
- Kubelet
- Kube-proxy

–¢–∞–∫–∂–µ –µ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –±–µ–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç, –Ω–æ –≤ –ª–µ–∫—Ü–∏–∏ –æ–Ω–∏ –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è. K8s –≤ —Ü–µ–ª–æ–º –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è. –í–¥–æ–±–∞–≤–æ–∫ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –∂–µ—Å—Ç–∫–∏–º–∏. 

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è: [Docker](https://youtu.be/TJg7QpqCH70), [Docker Compose –∏ Co](https://youtu.be/Hz7fkXQABNo)
–î–ª—è –∫–æ–Ω—Ç–µ–π–Ω–∏—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ [Docker](https://www.docker.com/) (–∫–æ—Ç–æ—Ä—ã–π, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –¥–µ–ø—Ä–µ–∫–µ–π—à–Ω, –≤—Å–µ –µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –æ–ø—Ü–∏–µ–π –≤ k8s), —Ç–∞–∫ –∏ [Podman](https://podman.io/), [Containerd](https://containerd.io/), [Cri-O](https://cri-o.io/) –∏ –ø—Ä–æ—á–∞—è.
- –°–µ—Ç—å: [–°–µ—Ç–∏ –ö—É–±–µ—Ä–Ω–µ—Ç–µ—Å –∏–∑–Ω—É—Ç—Ä–∏](https://youtu.be/6QKAt4TjxF8), [–°–µ—Ç—å k8s - —Å–µ—Ç–∞–ø –∫–ª–∞—Å—Ç–µ—Ä–∞](https://youtu.be/JNUD9j9QAnA)
–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: [Calico](https://docs.projectcalico.org/about/about-calico), [Weave Net](https://www.weave.works/oss/net/), [Cillium](https://cilium.io/), [Flannel](https://github.com/flannel-io/flannel)
[–î–æ–∫–∞ k8s](https://kubernetes.io/docs/concepts/cluster-administration/networking/)
- [DNS](https://youtu.be/MLp8_qVLkzc)
–°–µ–π—á–∞—Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º —è–≤–ª—è–µ—Ç—Å—è [Core dns](https://coredns.io/). –í –±–æ–ª–µ–µ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Å–≤—è–∑–∫–∞ [dnsmasq](https://thekelleys.org.uk/dnsmasq/doc.html) –∏ go'—à–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –∫ –Ω–µ–º—É. –í –ø—Ä–∏–Ω—Ü–∏–ø–µ –∫–∞–∫–∏–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∞–º dns –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s –Ω–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ, –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª —Å–æ–≤–º–µ—Å—Ç–∏–º —Å —Å–∞–º–∏–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º.

–í –ª–µ–∫—Ü–∏–∏ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏ –±—É–¥–µ—Ç —Ä–∞–∑–æ–±—Ä–∞–Ω –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö: —á—Ç–æ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å —Å –∑–∞–ø—É—Å–∫–∞–µ–º—ã–º ReplicaSet –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.

# –ú–∞—Å—Ç–µ—Ä –∫–æ–º–ø–æ–Ω–µ—Ç—ã

## [Etcd](https://youtu.be/0rN_tUIZx7Y?t=362)

![001_etcd.png](./assets/lesson_7/001_etcd.png)

–•—Ä–∞–Ω–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞—Å—Ç–µ—Ä–µ. –≠—Ç–æ –ë–î –∫–ª–∞—Å—Ç–µ—Ä–∞ k8s.

–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ etcd:

1. key-value
2. –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –∏ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
3. –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [raft](https://raft.github.io/). –û–±—ã—á–Ω–æ –∫–ª–∞—Å—Ç–µ—Ä etcd –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–¥, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—á–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–æ–±—ã—á–Ω–æ 3 –∏–ª–∏ 5). Raft –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–≤–æ—Ä—É–º (quorum), —á—Ç–æ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö - —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞–ª–∏—Å—å –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–º–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:
    1. –æ–Ω–∏ –í–°–ï–ì–î–ê –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω—ã –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º —Ä–µ–ø–ª–∏–∫ == –Ω–æ–¥ –∫–ª–∞—Å—Ç–µ—Ä–∞
    2. –í–°–ï–ì–î–ê —É —Ä–µ–ø–ª–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞—Å—Ç–µ—Ä == "–≥–ª–∞–≤–Ω–∞—è" –Ω–æ–¥–∞
    3. –µ—Å–ª–∏ –º–∞—Å—Ç–µ—Ä –∫—É–¥–∞-—Ç–æ –ø—Ä–æ–ø–∞–ª, –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ä–µ–ø–ª–∏–∫–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –≤—ã–±–∏—Ä–∞—é—Ç –Ω–æ–≤–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
    
    –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ.
    

[8:03](https://youtu.be/0rN_tUIZx7Y?t=483) –û–±—ã—á–Ω–æ –≤ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ k8s —Å—É—â–µ—Å—Ç–≤—É–µ—Ç 3 —Ä–∞–∑–Ω—ã—Ö –Ω–æ–¥—ã —Å etcd. –≠—Ç–æ —Ç–æ, —á—Ç–æ –º—ã –Ω–∞–∑—ã–≤–∞–µ–º –º–∞—Å—Ç–µ—Ä–Ω–æ–¥–∞–º–∏ etcd (–Ω–µ –ø—É—Ç–∞—Ç—å —Å –º–∞—Å—Ç–µ—Ä–æ–º –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫–≤–æ—Ä—É–º–∞). –ù–∞ —ç—Ç–∏ –∂–µ –Ω–æ–¥—ã –ø–æ—Ç–æ–º –±—Ü–¥—Ü—Ç —Å—Ç–∞–≤–∏—Ç—å—Å—è –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–Ω–∏–º–∞—é—Ç—Å—è –∏–º–µ–Ω–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

–í –æ–±—â–µ–º –∏ —Ü–µ–ª–æ–º –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–¥–Ω–æ–π –Ω–æ–¥–æ–π. Dev —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ–¥–Ω–æ–π.

<aside>
üî• –°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –ø—Ä–æ etcd: –≠—Ç–æ –ë–î –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ etcd, –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ etcd –∏ –±–æ–ª—å—à–µ –µ–µ –Ω–∏–≥–¥–µ –Ω–µ—Ç

</aside>

[Raft](http://thesecretlivesofdata.com/raft/)

–° consul'–æ–º k8s –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–æ–ª—å–∫–æ —Å etcd. –ü–æ–¥–¥–µ—Ä–∂–∫–∏ –¥—Ä—É–≥–∏—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â—å —É k8s –Ω–µ—Ç, –µ–º—É —ç—Ç–æ, –≤–ø—Ä–æ—á–µ–º, –∏ –Ω–µ –Ω—É–∂–Ω–æ.

## [API server](https://youtu.be/0rN_tUIZx7Y?t=572)

- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç k8s
- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π, –∫—Ç–æ –æ–±—â–∞–µ—Ç—Å—è —Å etcd
- –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ REST API - –º—ã —Å –Ω–∏–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ–º —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `kubectl` - –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º —à–ª—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ http –∑–∞–ø—Ä–æ—Å—ã –∫ API Server.
–ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `kubectl apply -v=10 -f <–∏–º—è-—Ñ–∞–π–ª–∞>` —Å –∫–ª—é—á–æ–º `-v=10` - —ç—Ç–æ –ø–æ–ª–Ω—ã–π=verbose mode –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `kubectl` –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥ —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.
–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞
    
    ```bash
    ...
    I1107 02:51:23.247699   13959 round_trippers.go:443] GET https://5.188.142.58:6443/api/v1/namespaces/<namespace-name> 200 OK in 63 milliseconds
    I1107 02:51:23.247783   13959 round_trippers.go:449] Response Headers:
    I1107 02:51:23.247836   13959 round_trippers.go:452]     Cache-Control: no-cache, private
    I1107 02:51:23.247866   13959 round_trippers.go:452]     Content-Type: application/json
    I1107 02:51:23.247892   13959 round_trippers.go:452]     X-Kubernetes-Pf-Flowschema-Uid: 211233d5-bef2-4121-9c8f-40d25ccae82e
    I1107 02:51:23.247922   13959 round_trippers.go:452]     X-Kubernetes-Pf-Prioritylevel-Uid: 07b62685-8e2d-4ab3-bbc1-4745e33a5d11
    I1107 02:51:23.247951   13959 round_trippers.go:452]     Content-Length: 469
    I1107 02:51:23.247972   13959 round_trippers.go:452]     Date: Sat, 06 Nov 2021 23:51:23 GMT
    I1107 02:51:23.248024   13959 request.go:968] Response Body: {"kind":"Namespace","apiVersion":"v1","metadata":{"name":"<namespace-name>","selfLink":"/api/v1/namespaces/<namespace-name>","uid":"ad1ecf95-f7c5-467b-b6e1-76676ea62a5a","resourceVersion":"2270162","creationTimestamp":"2021-10-01T00:59:35Z","managedFields":[{"manager":"kubectl-create","operation":"Update","apiVersion":"v1","time":"2021-10-01T00:59:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:phase":{}}}}]},"spec":{"finalizers":["kubernetes"]},"status":{"phase":"Active"}}
    I1107 02:51:23.248522   13959 request.go:968] Request Body: {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"name\":\"my-deployment\",\"namespace\":\"<namespace-name>\"},\"spec\":{\"replicas\":2,\"selector\":{\"matchLabels\":{\"app\":\"my-app\"}},\"strategy\":{\"rollingUpdate\":{\"maxSurge\":1,\"maxUnavailable\":1},\"type\":\"RollingUpdate\"},\"template\":{\"metadata\":{\"labels\":{\"app\":\"my-app\"}},\"spec\":{\"containers\":[{\"image\":\"quay.io/testing-farm/nginx:1.12\",\"livenessProbe\":{\"failureThreshold\":3,\"httpGet\":{\"path\":\"/\",\"port\":80},\"initialDelaySeconds\":10,\"periodSeconds\":10,\"successThreshold\":1,\"timeoutSeconds\":1},\"name\":\"nginx\",\"ports\":[{\"containerPort\":80}],\"readinessProbe\":{\"failureThreshold\":3,\"httpGet\":{\"path\":\"/\",\"port\":80},\"periodSeconds\":10,\"successThreshold\":1,\"timeoutSeconds\":1},\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"100Mi\"},\"requests\":{\"cpu\":\"10m\",\"memory\":\"100Mi\"}},\"startupProbe\":{\"failureThreshold\":30,\"httpGet\":{\"path\":\"/\",\"port\":80},\"periodSeconds\":10}}]}}}}\n"},"name":"my-deployment","namespace":"<namespace-name>"},"spec":{"replicas":2,"selector":{"matchLabels":{"app":"my-app"}},"strategy":{"rollingUpdate":{"maxSurge":1,"maxUnavailable":1},"type":"RollingUpdate"},"template":{"metadata":{"labels":{"app":"my-app"}},"spec":{"containers":[{"image":"quay.io/testing-farm/nginx:1.12","livenessProbe":{"failureThreshold":3,"httpGet":{"path":"/","port":80},"initialDelaySeconds":10,"periodSeconds":10,"successThreshold":1,"timeoutSeconds":1},"name":"nginx","ports":[{"containerPort":80}],"readinessProbe":{"failureThreshold":3,"httpGet":{"path":"/","port":80},"periodSeconds":10,"successThreshold":1,"timeoutSeconds":1},"resources":{"limits":{"cpu":"100m","memory":"100Mi"},"requests":{"cpu":"10m","memory":"100Mi"}},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/","port":80},"periodSeconds":10}}]}}}}
    I1107 02:51:23.248817   13959 round_trippers.go:423] curl -k -v -XPOST  -H "User-Agent: kubectl/v1.16.13 (linux/amd64) kubernetes/fd22db4" -H "Accept: application/json" -H "Content-Type: application/json" -H "Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjdqS2pSd2RFYzUtMVNlUmVTbm11aHFkTDRqSkw0TjVSbWx0MDBVWnpqMFEifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJzMDAwOTk4Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InMwMDA5OTgtdG9rZW4tZGxiZGYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiczAwMDk5OCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImNmNGExYWYxLTkxZTAtNDliNy04YTk4LTE1ZDc0Zjc5YmNkZSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpzMDAwOTk4OnMwMDA5OTgifQ.VT-zl-kRQPbn8V5X_JOH2kZ4u4ElZRbkxOjJoy5pYKnrt51bFo49gzdx9u-7CW75wmxF2Wu5Jf10OXFvTmiO8nSlOyZpe7Rv0__53udW1hLqew9vZ226L-Qv3rV99S8iz1d42Zldk1UJf_Hbn7t_GkACKRde8NQpCwhHuSnUKPp9yqSVtd4RI_BJWoUZs8l0xn6g2SM59m8mxON3sqf15hDCvz87TYiSZ8JYqybPmUgVZM2m80ILSaRX-Pv2vmwotf3PtHuLAnmpheqiTj7T3GI84ISjQ4BhWXYxyIGPXnWnY7u66jiYCzEveJFjFNnAWZsohhdMDthkdtnVc0-rhw" 'https://5.188.142.58:6443/apis/apps/v1/namespaces/<namespace-name>/deployments'
    I1107 02:51:23.337906   13959 round_trippers.go:443] POST https://5.188.142.58:6443/apis/apps/v1/namespaces/<namespace-name>/deployments 201 Created in 89 milliseconds
    I1107 02:51:23.337955   13959 round_trippers.go:449] Response Headers:
    I1107 02:51:23.337991   13959 round_trippers.go:452]     Cache-Control: no-cache, private
    I1107 02:51:23.338032   13959 round_trippers.go:452]     Content-Type: application/json
    I1107 02:51:23.338058   13959 round_trippers.go:452]     X-Kubernetes-Pf-Flowschema-Uid: 211233d5-bef2-4121-9c8f-40d25ccae82e
    I1107 02:51:23.338083   13959 round_trippers.go:452]     X-Kubernetes-Pf-Prioritylevel-Uid: 07b62685-8e2d-4ab3-bbc1-4745e33a5d11
    I1107 02:51:23.338112   13959 round_trippers.go:452]     Date: Sat, 06 Nov 2021 23:51:23 GMT
    I1107 02:51:23.338334   13959 request.go:968] Response Body: {"kind":"Deployment","apiVersion":"apps/v1","metadata":{"name":"my-deployment","namespace":"<namespace-name>","selfLink":"/apis/apps/v1/namespaces/<namespace-name>/deployments/my-deployment","uid":"d7930050-a35e-46b1-8606-2897ca984617","resourceVersion":"92966724","generation":1,"creationTimestamp":"2021-11-06T23:51:23Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"name\":\"my-deployment\",\"namespace\":\"<namespace-name>\"},\"spec\":{\"replicas\":2,\"selector\":{\"matchLabels\":{\"app\":\"my-app\"}},\"strategy\":{\"rollingUpdate\":{\"maxSurge\":1,\"maxUnavailable\":1},\"type\":\"RollingUpdate\"},\"template\":{\"metadata\":{\"labels\":{\"app\":\"my-app\"}},\"spec\":{\"containers\":[{\"image\":\"quay.io/testing-farm/nginx:1.12\",\"livenessProbe\":{\"failureThreshold\":3,\"httpGet\":{\"path\":\"/\",\"port\":80},\"initialDelaySeconds\":10,\"periodSeconds\":10,\"successThreshold\":1,\"timeoutSeconds\":1},\"name\":\"nginx\",\"ports\":[{\"containerPort\":80}],\"readinessProbe\":{\"failureThreshold\":3,\"httpGet\":{\"path\":\"/\",\"port\":80},\"periodSeconds\":10,\"successThreshold\":1,\"timeoutSeconds\":1},\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"100Mi\"},\"requests\":{\"cpu\":\"10m\",\"memory\":\"100Mi\"}},\"startupProbe\":{\"failureThreshold\":30,\"httpGet\":{\"path\":\"/\",\"port\":80},\"periodSeconds\":10}}]}}}}\n"},"managedFields":[{"manager":"kubectl","operation":"Update","apiVersion":"apps/v1","time":"2021-11-06T23:51:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{"f:progressDeadlineSeconds":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:strategy":{"f:rollingUpdate":{".":{},"f:maxSurge":{},"f:maxUnavailable":{}},"f:type":{}},"f:template":{"f:metadata":{"f:labels":{".":{},"f:app":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"nginx\"}":{".":{},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:failureThreshold":{},"f:httpGet":{".":{},"f:path":{},"f:port":{},"f:scheme":{}},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":80,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:httpGet":{".":{},"f:path":{},"f:port":{},"f:scheme":{}},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:startupProbe":{".":{},"f:failureThreshold":{},"f:httpGet":{".":{},"f:path":{},"f:port":{},"f:scheme":{}},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}}}}}]},"spec":{"replicas":2,"selector":{"matchLabels":{"app":"my-app"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app":"my-app"}},"spec":{"containers":[{"name":"nginx","image":"quay.io/testing-farm/nginx:1.12","ports":[{"containerPort":80,"protocol":"TCP"}],"resources":{"limits":{"cpu":"100m","memory":"100Mi"},"requests":{"cpu":"10m","memory":"100Mi"}},"livenessProbe":{"httpGet":{"path":"/","port":80,"scheme":"HTTP"},"initialDelaySeconds":10,"timeoutSeconds":1,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"readinessProbe":{"httpGet":{"path":"/","port":80,"scheme":"HTTP"},"timeoutSeconds":1,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"startupProbe":{"httpGet":{"path":"/","port":80,"scheme":"HTTP"},"timeoutSeconds":1,"periodSeconds":10,"successThreshold":1,"failureThreshold":30},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","securityContext":{},"schedulerName":"default-scheduler"}},"strategy":{"type":"RollingUpdate","rollingUpdate":{"maxUnavailable":1,"maxSurge":1}},"revisionHistoryLimit":10,"progressDeadlineSeconds":600},"status":{}}
    ```
    
    –ë–æ–ª–µ–µ —Ç–æ–≥–æ, —Ç.–∫. —ç—Ç–æ REST, –Ω–∏–∫—Ç–æ –Ω–µ –º–µ—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `curl`, –ø–∏—Å–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å API Servre k8s –∏ –¥–µ–ª–∞—Ç—å —Å –Ω–∏–º –≤—Å–µ, —á—Ç–æ –∑–∞—Ö–æ—á–µ—Ç—Å—è
    
- Authentication and authorization. –í—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ API Server.
–ï—Å–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –Ω–µ–π–º—Å–ø–µ–π—Å, —Ç–æ –µ–≥–æ –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É –Ω–µ–π–º—Å–ø–µ–π—Å—É —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API Server. –ï—Å–ª–∏ —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ—á–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —á—É–∂–æ–º—É –Ω–µ–π–º—Å–ø–µ–π—Å—É, —Ç–æ –ø–æ–ª—É—á–∏—Ç—å –æ—à–∏–±–∫—É "forbidden ... –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ ..." - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä—è, API Server —Ç–æ—Ç, –∫—Ç–æ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç/–∑–∞–ø—Ä–µ—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º. –í –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –ª–µ–∫—Ü–∏—è—Ö –±—É–¥—É—Ç –∏–∑—É—á–∞—Ç—å—Å—è –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ –º–µ—Ö–∞–Ω–∏–∑–º [RBAC (Role-Based Access Control)](https://kubernetes.io/docs/reference/access-authn-authz/rbac/).

API Server –Ω–µ —Ç–æ–ª—å–∫–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã —Å –Ω–∏–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ–º), —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞: –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –±–µ—Ä—É—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ API Server'–∞, —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ API Server - –æ–±–Ω–æ–≤–ª—è—è —Å–≤–æ–π —Å—Ç–∞—Ç—É—Å, –æ–±–Ω–æ–≤–ª—è—è —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—â–µ–Ω –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

–¢—É—Ç –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ API Server - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±—â–∞–µ—Ç—Å—è —Å etcd. –¢.–µ. API Server —Å–∞–º –ø–æ —Å–µ–±–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–µ —Ö—Ä–∞–Ω–∏—Ç - –æ–Ω –µ–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –≤ etcd, –æ–Ω –µ–µ –∏–∑ etcd —á–∏—Ç–∞–µ—Ç, —Ç.–µ. —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —è–≤–ª—è–µ—Ç—Å—è stateless –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º, –∫–∞–∫ –∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–Ω–µ–Ω—Ç—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s, –∫—Ä–æ–º–µ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–∞–º–æ–≥–æ etcd.

API Server –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π, –∫—Ç–æ –æ–±—â–∞–µ—Ç—Å—è —Å etcd.

etcd –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π, –∫—Ç–æ —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞—Å—Ç–µ—Ä–µ.

**–ü–æ –ø–æ–≤–æ–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ API Server:**
–æ–Ω –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è, —É –Ω–µ–≥–æ –Ω–µ—Ç –ø–æ–Ω—è—Ç–∏—è –º–∞—Å—Ç–µ—Ä-–≤–µ–¥–æ–º—ã–π. –û–±—ã—á–Ω–æ –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞—é—Ç 3 –Ω–æ–¥—ã —Å –º–∞—Å—Ç–µ—Ä–æ–º, —Ç.–µ. –ø—Ä–æ—Å—Ç–æ 3 —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª–∫–µ/—Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö. –ù–∞ –∫–∞–∂–¥—É—é –Ω–æ–¥—É —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –ø–æ etcd –∏ –ø–æ API Server'–µ. –ü—Ä–∏ —ç—Ç–æ–º API Server'–∞ —Å–º–æ—Ç—Ä—è—Ç –∫–∞–∫ –±—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä etcd, –æ–±—â–∞—é—Ç—Å—è —Å etcd. 

–¢—É—Ç –µ—Å—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:

- –ª–∏–±–æ –∫–∞–∂–¥—ã–π API Server —Å–º–æ—Ç—Ä–∏ –≤ —Å–≤–æ–π etcd
- –ª–∏–±–æ API Server'–∞ —Å–º–æ—Ç—Ä—è—Ç –≤–æ –≤—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã etcd –∏ –æ–±—â–∞—é—Ç—Å—è —Å –Ω–∏–º –∫–∞–∫ —Å –∫–ª–∞—Å—Ç–µ—Ä–æ–º

–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –æ—Å–æ–±–æ–π —Ä–æ–ª–∏ –Ω–µ –∏–≥—Ä–∞–µ—Ç.

–ù–æ API Server'–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏. –ü–æ–º–Ω–∏–º, —á—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ –∑–∞–ø—Ä–µ—â–∞–µ—Ç –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ API Server'–∞ - –ø—Ä–æ—Å—Ç–æ –µ—Å–ª–∏ –æ–Ω –≤—ã–π–¥–µ—Ç –∏–∑ —Å—Ç—Ä–æ—è, –∫–ª–∞—Å—Ç–µ—Ä–æ–º —É–ø—Ä–∞–≤–ª—è—Ç—å –±—É–¥–µ—Ç –Ω–µ–ª—å–∑—è.

### –†–∞–±–æ—Ç–∞ API Server –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

![002_api_server.png](./assets/lesson_7/002_api_server.png)

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ ReplicaSet, –∞ –Ω–µ Deployement, –∫–∞–∫ —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ 100% —Å–ª—É—á–∞—è—Ö –±—ã–≤–∞–µ—Ç –≤ –∂–∏–∑–Ω–∏. –ü–æ–∑–∂–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ, –≥–¥–µ –∏ —á—Ç–æ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è –≤ —Å–ª—É—á–∞–µ Deployment.

–ü–æ–º–Ω–∏–º, —á—Ç–æ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ ReplicaSet –µ—Å—Ç—å template, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è Pod'—ã. –í template –µ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏–µ, —Å–∫–æ–ª—å–∫–æ —Ä–µ–ø–ª–∏–∫ –∏–∑ —à–∞–±–ª–æ–Ω–∞ Pod'–∞ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ—Ä–µ—Ç yaml —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º ReplicaSet, –Ω–∞–ø—Ä–∏–º–µ—Ä, replicaset.yaml
2. –° –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `kubectl create/apply -f replicaset.yaml` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è ReplicaSet –∏ –≤—Å–µ—Ö –Ω–∏–∂–µ–ª–µ–∂–∞—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. kubectl –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ API Server (–ø–æ–º–Ω–∏–º, —á—Ç–æ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å kubectl –≤—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å API Server —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–∞ `-v=10`, –ø–æ–¥—Ä–æ–±–Ω–µ–µ –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ —Å–ø—Ä–∞–≤–∫–µ `kubectl options`)
4. –ø–µ—Ä–µ–¥–∞–µ—Ç —Ç—É–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è ReplicaSet
5. –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ yaml, –∫–æ—Ç–æ—Ä–æ–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ç—å—Å—è –≤ json
6. API Server –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –ø–æ—è–≤–∏–ª—Å—è ReplicaSet, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ etcd
7. etcd –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é –∫–≤–æ—Ä—É–º–∞ –æ—Ç–≤–µ—á–∞–µ—Ç API Server'y, —á—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
8. –ü–æ—Å–ª–µ —á–µ–≥–æ API Server –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç kubectl (–∞ —Ç–æ—Ç –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –≤—ã–≤–æ–¥–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é), —á—Ç–æ ReplicaSet –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —Å–æ–∑–¥–∞–ª—Å—è
    
    <aside>
    üî• –ü—Ä–∏ —ç—Ç–æ–º –¥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s –µ—â–µ –¥–æ–≤–æ–ª—å–Ω–æ –¥–∞–ª–µ–∫–æ.
    –ù–∞ —ç—Ç–æ–º –º–æ–º–µ–Ω—Ç–µ –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s –µ—â–µ –Ω–µ—Ç. –í—Å–µ, —á—Ç–æ —Ç–∞–º –µ—Å—Ç—å - —ç—Ç–æ –∑–∞–ø–∏—Å—å –≤ etcd –æ —Ç–æ–º, —á—Ç–æ –∫–∞–∫–æ–π-—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–ª –≤ –∫–∞–∫–æ–º-—Ç–æ –Ω–µ–π–º—Å–ø–µ–π—Å–µ ReplicaSet —Å —Ç–∞–∫–∏–º-—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤ —Ç–∞–∫–æ–º-—Ç–æ —Ñ–æ—Ä–º–∞—Ç–µ.
    
    </aside>
    
9. –ù–∞ —Å–ª–∞–π–¥–µ –≤—ã—à–µ —É–∫–∞–∑–∞–Ω–∞ –≥—Ä—É–ø–ø–∞ Others - —ç—Ç–æ, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞ k8s, –∫–æ—Ç–æ—Ä—ã–µ —Å–º–æ—Ç—Ä—è—Ç –≤ API Server, –≤–∏–¥—è—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ —Ç–∞–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏ –ø—ã—Ç–∞—é—Ç—Å—è –∫–∞–∫-—Ç–æ –¥–∞–ª—å—à–µ —Å —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —Ä–∞–±–æ—Ç–∞—Ç—å. –ü—Ä–æ —Ç–µ—Ö, –∫—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ –≥—Ä—É–ø–ø—É Others –Ω–∏–∂–µ.

## [Controller-manager](https://youtu.be/0rN_tUIZx7Y?t=1003)

–§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –æ–¥–∏–Ω –±–∏–Ω–∞—Ä–Ω–∏–∫, —Ä–æ–≤–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã k8s: API Server, etcd –∏ –¥—Ä—É–≥–∏–µ.

–ï—Å—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏, –∫–æ–≥–¥–∞ –µ–≥–æ –∑–∞–ø—É—Å–∫–∞—é—Ç –≤–Ω–µ –∫–ª–∞—Å—Ç–µ—Ä–∞, –≤–Ω–µ docker'–∞, –≤–Ω–µ –∫–æ–Ω—Ç–µ–Ω–µ—Ä–∞, –ø—Ä–æ—Å—Ç–æ, –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, systemd unit. 
–ù–æ –æ–±—ã—á–Ω–æ —ç—Ç–æ —Ç–∞–∫–æ–π –∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Ç–∞–∫–æ–π –∂–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞ –∫–∞–∫ –∏ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ. –ò etcd –∑–∞–ø—É—Å–∫–∞—é—Ç –∫–∞–∫ —á–∞—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∞, —Ç.–µ. –∫–∞–∫ Pod –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, –∏ API –º–µ–Ω–µ–¥–∂–µ—Ä, –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è Controller-manager –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–¥–∏–Ω –±–∏–Ω–∞—Ä—å, –∫–æ—Ç–æ—Ä—ã–π –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Å–æ–¥–µ—Ä–∂–∏—Ç n'–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤.

**–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä?**

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞ k8s - —ç—Ç–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ç–æ, —á—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–∞–º–∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ k8s, –∫–∞–∫-—Ç–æ —Å –Ω–∏–º–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ—Ç Pod'—ã –∏–∑ ReplicaSet'–æ–≤. –°–æ–∑–¥–∞–µ—Ç CronJob'—ã, Job'—ã, –∏–∑ –Ω–∏—Ö —á—Ç–æ-—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ç. –ó–∞–Ω–∏–º–∞–µ—Ç—Å—è GarbageCollector. –ò —Ç–∞–∫ –¥–∞–ª–µ–µ.

- –ù–∞–±–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
    - [Node controller](https://youtu.be/0rN_tUIZx7Y?t=1105). –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –Ω–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–æ—Å—Ç—è—Ç –æ —Å–µ–±–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –¢.–µ. –æ–Ω –Ω–µ —Ö–æ–¥–∏—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–¥—É –æ–ø—Ä–∞—à–∞–≤–∏–∞—Ç—å –æ –µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –æ–Ω –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–∏ –≤ API Server –∏ –≤–∏–¥–∏—Ç, —á—Ç–æ –∫–∞–∫–∞—è-—Ç–æ –Ω–æ–¥–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –ø–æ—Å—Ç–∏—Ç—å —Å–≤–æ–π —Å—Ç–∞—Ç—É—Å.
        - –í—Å–µ –Ω–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∞ k8s —Ä–∞–∑ –≤ –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è –ø–∏—à—É—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ –≤ API Server, –≥–æ–≤–æ—Ä—è "—è –≤—Å–µ –µ—â–µ –∂–∏–≤–æ–π, —è –Ω–∞ –º–µ—Å—Ç–µ, —è —Ç—É—Ç".
        - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –≤—Å–µ –Ω–æ–¥—ã, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –ø–∏—à—É—Ç –æ —Å–µ–±–µ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∑–Ω–∞—á–∏—Ç —Å –∫–ª–∞—Å—Ç–µ—Ä–æ–º –≤—Å–µ —Ö–æ—Ä–æ—à–æ.
        - –ï—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –Ω–æ–¥–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –æ —Å–µ–±–µ –ø–∏—Å–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ –∫–∞–∫–æ–π-—Ç–æ —Å—Ä–æ–∫ (–∫–æ—Ç–æ—Ä—ã–π –∑–∞–¥–∞–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö), —Ç–æ node controller
            - –∑–∞–º–µ—Ç–∏—Ç —ç—Ç—É —Å–∏—Ç—É—Ü–∏—é,
            - –ø–æ–º–µ—Ç–∏—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s, —Ç.–µ. —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—Å—Ç –≤ API Server –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–∞ –Ω–æ–¥–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞,
            - –∞ –¥–∞–ª–µ–µ –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–Ω–æ—Å–∞ Pod'–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –Ω–∞ —ç—Ç–æ–π –Ω–æ–¥–µ, –Ω–∞ –¥—Ä—É–≥–∏–µ –Ω–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    - [Replicaset controller](https://youtu.be/0rN_tUIZx7Y?t=1191). –ö–æ–≥–¥–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è ReplicaSet, —É ReplicaSet –µ—Å—Ç—å —Ç–µ–º–ø–ª–µ–π—Ç Pod'–æ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ–º Pod'–æ–≤ –ø–æ —ç—Ç–æ–º—É –æ–ø–∏—Å–∞–Ω–∏—é –∫–∞–∫ —Ä–∞–∑ –∏ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è Replicaset controller.
        - –¢.–µ. –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å–º–æ—Ç—Ä–∏—Ç –≤ API Server –∏,
            - –∫–æ–≥–¥–∞ –≤–∏–¥–∏—Ç, —á—Ç–æ —Ç–∞–º –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ ReplicaSet —Å —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤ –¥–ª—è Pod'–æ–≤, –ø–ª—é—Å –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–µ–ø–ª–∏–∫,
            - —Ç–æ —Å–æ–∑–¥–∞–µ—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –Ω—É–∂–Ω—ã–µ Pod'—ã
            - –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∏—Ö –≤ API Server
    - [Endpoints controller](https://youtu.be/0rN_tUIZx7Y?t=1268). –í k8s –µ—Å—Ç—å —Ç–∞–∫–∞—è —Å—É—â–Ω–æ—Å—Ç—å –∫–∞–∫ Endopoint'—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
    - –ò –¥—Ä—É–≥–∏–µ ...
    
    <aside>
    üßê –ö–æ–≥–¥–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s —á—Ç–æ-—Ç–æ –∏–∑ —á–µ–≥–æ-—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è, —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫–æ–π-—Ç–æ —Å–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤–Ω—É—Ç—Ä–∏ Controller-manager.
    –í –∫–ª–∞—Å—Ç–µ—Ä–µ k8s –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Ä–∞–∑–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∑–∞ –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –æ—Ç–≤–µ—á–∞–µ—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä - –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ –æ–ø–∏—Å–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
    
    </aside>
    
- [GarbageCollector](https://youtu.be/0rN_tUIZx7Y?t=1308) - "—Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞". 
–í–æ–∑—å–º–µ–º, –∫ –ø—Ä–∏–º–µ—Ä—É, —Ä–∞–±–æ—Ç—É Deployment controller
    - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–ø–∏—Å–∞–Ω–∏—è ReplicaSet –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã ReplicaSet
    - –ø—Ä–∏ —ç—Ç–æ–º —Å—Ç–∞—Ä—ã–µ ReplicaSet —É–¥–∞–ª–µ–Ω—ã –Ω–µ –±—É–¥—É—Ç,
    - –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ "—Å—Ç–∞—Ä—ã—Ö" ReplicaSet, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è, –æ—Ç–≤–µ—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä [revisionHistoryLimit](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#revision-history-limit) (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = 10).
    - –ö–∞–∫ —Ç–æ–ª—å–∫–æ —É Deployment'–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö ReplicaSet –ø—Ä–µ–≤—ã—à–∞–µ—Ç —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä, –∑–∞–¥–∞—á–∞ Controller-manager –Ω–∞–π—Ç–∏ —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π ReplicaSet –∏ —É–¥–∞–ª–∏—Ç—å –µ–≥–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞, —Ç.–µ. –æ–Ω –ø–æ–¥—á–∏—Ç–∞—â–∞–µ—Ç —Ç–æ—Ç –º—É—Å–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±–æ–ª—å—à–µ —É–∂–µ –Ω–µ –Ω—É–∂–µ–Ω.

**[–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Controller Manager –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ](https://youtu.be/0rN_tUIZx7Y?t=1629):**

Controller Manager, –∫–∞–∫ –∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ k8s, –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω –∏ –±–æ–ª–µ–µ.

–¢.–∫. —ç—Ç–æ –º–∞—Å—Ç–µ—Ä–æ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —Ç.–µ. —Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∫–ª–∞—Å—Ç–µ—Ä–∞, —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –≤ —Ç–æ–π –∏–ª–∏ –∏–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ etcd –∏ API Server, –æ–Ω–∏ –æ–±—ã—á–Ω–æ —Å—Ç–æ—è—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–æ–¥–∞—Ö, —Ç.–µ. —Ç–∞–º –∂–µ –≥–¥–µ API Server –∏ etcd, –Ω–æ –Ω–µ —Ç–∞–º –∂–µ, –≥–¥–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.

–î–ª—è dev –≤ –º–∞–ª–µ–Ω—å–∫–æ–º –ø—Ä–æ—Å—Ç–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω Controller Manager, –Ω–æ –æ–±—ã—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—Ç —Ç–∞–∫ –∂–µ 3 - –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—ã–π –∏–∑ master node.

–£ Controller Manager –µ—Å—Ç—å –∫–∞–∫ —Ä–∞–∑ —Ç–∞–∫–∏ –ø–æ–Ω—è—Ç–∏–µ –º–∞—Å—Ç–µ—Ä-–≤–µ–¥–æ–º—ã–π –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç—É –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω Controller Manager.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã–±–∏—Ä–∞—Ç—å —Å–µ–±–µ –º–∞—Å—Ç–µ—Ä–∞ –∏ –ø–æ–Ω–∏–º–∞—Ç—å, –∫—Ç–æ –∏–∑ –Ω–∏—Ö —Å–µ–π—á–∞—Å –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É, –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ö–∞–Ω–∏–∑–º [Lease](https://medium.com/michaelbi-22303/deep-dive-into-kubernetes-simple-leader-election-3712a8be3a99):

**[–í–∫—Ä–∞—Ç—Ü–µ –æ Lease](https://youtu.be/0rN_tUIZx7Y?t=1680):**

–ö–æ–≥–¥–∞ –Ω–∞—à–∏ 3 Controller Manager'–∞ —Å—Ç–∞—Ä—Ç—É—é—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –ø—ã—Ç–∞–µ—Ç—Å—è –≤ API Server –∑–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –æ–Ω –º–∞—Å—Ç–µ—Ä –∏ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É. 

–ü–µ—Ä–≤—ã–π, —É –∫–æ–≥–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å –∑–∞–ø–∏—Å–∞—Ç—å —Ç–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–∞—Å—Ç–µ—Ä–æ–º. 

–û—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∏–¥—è—Ç, —á—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —É–∂–µ –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, —á—Ç–æ –µ—Å—Ç—å –º–∞—Å—Ç–µ—Ä controller manager –∏ –¥–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ —Å–ª–µ–¥—è—Ç –∑–∞ —Ç–µ–º, —á—Ç–æ master —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ, —Ç.–µ. –æ–Ω –∂–∏–≤–æ–π –∏ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–æ–π.

–ï—Å–ª–∏ –º–∞—Å—Ç–µ—Ä –≤ —Ç–µ—á–µ–Ω–∏–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –æ–±–Ω–æ–≤–∏–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ–≥–æ –±–æ–ª—å—à–µ –Ω–µ—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—å Controller Manager —Ä–æ–≤–Ω–æ –ø–æ —Ç–æ–º—É –∂–µ –∞–ª–≥–æ—Ä–∏—Ç–º—É –±—É–¥—É—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–æ–ø–∏—Å–∞—Ç—å —Å–µ–±—è –º–∞—Å—Ç–µ—Ä–æ–º. –ü–µ—Ä–≤—ã–π —É –∫–æ–≥–æ —ç—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º –º–∞—Å—Ç–µ—Ä–æ–º.

–ï—Å–ª–∏ —á–µ—Ä–µ–∑ –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è —Å—Ç–∞—Ä—ã–π –º–∞—Å—Ç–µ—Ä –æ–∂–∏–≤–∞–µ—Ç, —Ç–æ –æ–Ω –≤–∏–¥–∏—Ç, —á—Ç–æ –æ–Ω –±–æ–ª—å—à–µ –Ω–µ –º–∞—Å—Ç–µ—Ä –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞.

### [Q&A](https://youtu.be/0rN_tUIZx7Y?t=1398)

1. **Q:** –û—Ç–∫—É–¥–∞ node manager –∑–Ω–∞–µ—Ç –æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º —É–ø–∞–≤—à–µ–π –Ω–æ–¥—ã –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞, –µ—Å–ª–∏ –≤—Å—è —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ etcd
**A:** –í—Å–µ –≤–µ—Ä–Ω–æ, –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ etcd. 
    1. Controller manager –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ API Server'y. 
    –¢.–µ. –µ—Å–ª–∏ controller manager'y –Ω—É–∂–Ω–∞ –∫–∞–∫–∞—è-—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –æ–Ω —Ö–æ—Ç–µ–ª –±—ã –∑–Ω–∞—Ç—å –æ –Ω–æ–¥–µ –∏–ª–∏ –æ —á–µ–º-—Ç–æ –µ—â–µ, –æ–Ω–æ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ API Server'y —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –ø–æ–º–æ—â—å—é `kubectl`, –Ω–∞–ø—Ä–∏–º–µ—Ä, `kubectl get pod ...` –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –≤ –∞–ø–∏, –Ω–æ —Å—É—Ç—å —Ç–∞ –∂–µ. 
    2. –ò API Server –ª–µ–∑–µ—Ç –≤ etcd, —Å–æ–±–∏—Ä–∞–µ—Ç —Ç–∞–º –≤—Å—é –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –æ—Ç–¥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ.
2. **Q:** –ö–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –Ω–æ–¥–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ—É node-controller'y?
**A:** kubelet –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ API Server (–∏ –±–æ–ª—å—à–µ –Ω–∏–∫–æ–º—É). –í—Å–µ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –≤ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –º–æ–≥—É—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –µ–µ —É API Server'–∞. –¢.–µ. node-controller —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç API Server –æ —Å—Ç–∞—Ç—É—Å–µ –Ω–æ–¥: —á—Ç–æ —Ç–∞–º kubelet –ø–∏—Å–∞–ª –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∏ —Ç.–¥.

### [–†–∞–±–æ—Ç–∞ Controller-manager –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ](https://youtu.be/0rN_tUIZx7Y?t=1512)

![003_controller_manager.png](./assets/lesson_7/003_controller_manager.png)

–°–µ—Ä–µ–Ω—å–∫–∏–º –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã —ç—Ç–∞–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –±—ã–ª–∏ –ø—Ä–æ–π–¥–µ–Ω—ã (—Å–º. –≤—ã—à–µ –≤ —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–æ API Server).

1. –ü—Ä–æ—Ü–µ—Å—Å Controller-manager –≤—Å–µ–≥–¥–∞ –≤–∏—Å–∏—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
2. –°–º–æ—Ç—Ä–∏ –≤ API Server - —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "–ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Å–æ–±—ã—Ç–∏—è"
–†–∞—Å–º–æ—Ç—Ä–∏–º —Å–∏—Ç—É–∞—Ü–∏—é –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Replication Controller.
    1. Replication Controller –ø–æ–¥–ø–∏—Å–∞–Ω –∫ API Server'y –Ω–∞ —Å–æ–±—ã—Ç–∏–µ "–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ ReplicaSet"
    2. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ç–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, Controllare Manager, –∞ —Ç–æ—á–Ω–µ–µ Replica Controller –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ, –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç API Server –¥–∞–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ.
    3. Controller Manager –±–µ—Ä–µ—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç –Ω—É–∂–Ω–æ–≥–æ ReplicaSet —É API Server'–∞
    4. –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—è templates –≥–µ–Ω–µ—Ä–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ Pod'–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json
    5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≤ API Server.
    6. API Server —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç —ç—Ç–æ –≤ etcd 
    7. –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç Contreller Manager'y, —á—Ç–æ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –∑–∞–ø–∏—Å—å –æ Pod'–µ.
    
    <aside>
    ‚ÄºÔ∏è –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –µ—â–µ –Ω–∏–∫–∞–∫–∏—Ö Pod'–æ–≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s –Ω–µ—Ç, –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ –≤ etcd —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º Pod'–æ–≤.
    
    </aside>
    

## [Scheduler](https://youtu.be/0rN_tUIZx7Y?t=1768)

–¢–∞–∫–∂–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –≥—Ä—É–ø–ø–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–∞—Å—Ç–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–Ω–∏–º–∞—é—Ç—Å—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ k8s.

–ù–∞–∑–Ω–∞—á–∞–µ—Ç Pod'—ã –Ω–∞ –Ω–æ–¥—ã (–∫–æ—Ç–æ—Ä—ã–µ —É –Ω–∞—Å –±—ã–ª–∏ –Ω–∞–≥–µ–Ω–µ—Ä–µ–Ω—ã Controller-manager, —Å–º. –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑–¥–µ–ª), —É—á–∏—Ç—ã–≤–∞—è:

- [QoS (Quolity of Service)](https://youtu.be/0rN_tUIZx7Y?t=1823) –ø–æ–ª–∏—Ç–∏–∫–∞. –í –∑–∞–≤–∏—Å–∏–æ–º—Å—Ç–∏ –æ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ limit –∏ request scheduler –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ, –∫—É–¥–∞ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –¥–∞–Ω–Ω—ã–π Pod.
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–∞ –∫–∞–∫–∏—Ö-—Ç–æ –Ω–æ–¥–∞—Ö –µ—Å—Ç—å –Ω–µ—Ö–≤–∞—Ç–∫–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, —Ç–æ –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ —Ç—É–¥–∞ –Ω–µ –±—É–¥—É—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å—Å—è Pod'—ã. 
–ï—Å–ª–∏ –Ω–∞ –∫–∞–∫–∏—Ö-—Ç–æ –Ω–æ–¥–∞—Ö –µ—Å—Ç—å –º–Ω–æ–≥–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, —Ç–æ Pod'—ã best effort, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —É–∫–∞–∑–∞–Ω–æ –Ω–∏ –ª–∏–º–∏—Ç–æ–≤, –Ω–∏ —Ä–µ–∫–≤–µ—Å—Ç–æ–≤, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –±—É–¥—É—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å—Å—è –Ω–∞ —Ç–∞–∫–∏–µ –Ω–æ–¥—ã.
- [Affinity / anti-affinity](https://youtu.be/0rN_tUIZx7Y?t=1867). –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –º–µ—Ö–∞–Ω–∏—Ö–º –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ k8s, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ "—è –±—ã —Ö–æ—Ç–µ–ª, —á—Ç–æ–±—ã –≤–æ—Ç —ç—Ç–∏ Pod'—ã –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ –Ω–æ–¥". –ù–∞–ø—Ä–∏–º–µ—Ä –Ω–∞ –Ω–æ–¥–∞—Ö, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å gpu (–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –∏ —Ç.–¥.). –ò–ª–∏ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤ —ç—Ç–∞ –≥—Ä—É–ø–ø–∞ Pod'–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Pod'–æ–≤ –æ–¥–Ω–æ–≥–æ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞) –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–æ–≥–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–π –∏ —Ç–æ–∂–µ –∂–µ –Ω–æ–¥–µ, —Ç.–µ. —á—Ç–æ–±—ã –∫–ª–∞—Å—Ç–µ—Ä k8s –≤—Å–µ–≥–¥–∞ –∏—Ö —Ä–∞–∑–º–∞–∑—ã–≤–∞–ª –ø–æ —Ä–∞–∑–Ω—ã–º –Ω–æ–¥–∞–º.
- [Requested resources](https://youtu.be/0rN_tUIZx7Y?t=1904). K8s —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –≤–∞—à–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ –Ω–æ–¥–∞–º, —Ç.–µ. –µ—Å–ª–∏ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–¥–µ –∑–∞–Ω—è—Ç–æ 2 cpu, –∞ –Ω–∞ –¥—Ä—É–≥–æ–π 0, —Ç–æ scheduler —ç—Ç–æ –≤–∏–¥–∏—Ç, –æ–Ω –≤—Å—é —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –∏–∑ API Server'–∞ (—Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ Controller Manager –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ) –∏ –æ–Ω –ø—Ä–∏–º–µ—Ç —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –∫–∞–∂–µ—Ç—Å—è —ç—Ç–æ—Ç Pod –±–æ–ª–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –∏ –µ–≥–æ –Ω–∞–¥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –Ω–æ–¥—É, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –∑–∞–Ω—è—Ç—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.
–ï—Å–ª–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º –≥–æ–≤–æ—Ä–∏—Ç—å, —Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å–µ —ç—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
    - –°–Ω–∞—á–∞–ª–∞ scheduler —É–±–∏—Ä–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –Ω–æ–¥ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ –Ω–µ –ø–æ–¥–æ–π–¥—É—Ç
    - –ó–∞—Ç–µ–º –≤–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º scoring'–∞ (–æ—Ç score=–±–∞–ª–ª) –¢.–µ. –æ–Ω –∫–∞–∂–¥–æ–π –∏–∑ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –Ω–æ–¥—ã (–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º) –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –≤—Å—è—á–µ—Å–∫–∏—Ö —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫, –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–ª–ª—ã –ø–æ –∫–∞–∂–¥–æ–º—É –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —É–º–µ–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å.
    - –ù–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –±–∞–ª–ª–æ–≤, –≤ –∏—Ç–æ–≥–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–æ–π –Ω–æ–¥–æ–π, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é–±—É–¥–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω Pod - –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–æ –∏—Ç–æ–≥—É.
- Priority Class
–£ –Ω–∞—Å –µ—Å—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –ø–æ–¥—ã –±–æ–ª–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ, –∫–∞–∫–∏–µ-—Ç–æ –º–µ–Ω–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ. 
–ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –µ—Å—Ç—å —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏ –∏, –µ—Å–ª–∏ –æ–Ω –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–ª—á–∞—Å–∞ –∏ —Ä–∞—Å—Å—ã–ª–∫–∏ –ø—Ä–∏–¥—É—Ç –ø–æ–∑–∂–µ, —Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ —É–º—Ä–µ—Ç.

–ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –ª–µ–∫—Ç–æ—Ä–∞:

–û–¥–Ω–∞ –∏–∑ –ø–æ–ª–∏—Ç–∏–∫ scoring'–∞, –∫–æ—Ç–æ—Ä–∞—è –µ—Å—Ç—å –≤ scheduler - —ç—Ç–æ —Å–∫–∞—á–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑ –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—á–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –≤–∞—à –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

–¢.–µ. scheduler –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç —Å—Ä–µ–¥–∏ –ø—Ä–æ—á–µ–≥–æ —Ç—É –Ω–æ–¥—É, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —É–∂–µ –µ—Å—Ç—å –æ–±—Ä–∞–∑ –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—á–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –≤–∞—à –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä - Pod.

–ü—Ä–∏ –ø—Ä–æ—á–∏—Ö —Ä–∞–≤–Ω—ã—Ö, –µ—Å–ª–∏ –Ω–∞ –Ω–æ–¥–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å, —Ç–æ scheduler –≤—ã–±–µ—Ä–µ—Ç —ç—Ç—É –Ω–æ–¥—É.

–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –ª–µ–∫—Ç–æ—Ä–æ–º –ø—Ä–∏–º–µ—Ä–µ, –¥–∞–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –º–µ—à–∞–ª—Å—è –∏ –æ–Ω–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –µ–≥–æ –æ—Ç–∫–ª—é—á–∞–ª–∏ (–¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤).

<aside>
üí° –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ —á—Ç–æ —É–º–µ–µ—Ç –¥–µ–ª–∞—Ç—å Scheduler - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –ø–æ–¥—ã, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —á–µ–º-—Ç–æ

</aside>

### –†–∞–±–æ—Ç–∞ Scheduler –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

![004_scheduler.png](./assets/lesson_7/004_scheduler.png)

1. Controller manager —Å–æ–∑–¥–∞–ª –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–∞ 
2. –∏ —Å–ª–æ–∂–∏–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ json –≤ api server
3. scheduler —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ controller manager –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏–µ –≤ k8s: —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç - —ç—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–¥–æ–≤
4. –∫–∞–∫ —Ç–æ–ª—å–∫–æ scheduler –≤–∏–¥–∏—Ç –≤ k8s api serever —Å–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –±—ã–ª –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –Ω–æ–¥—É
5. scheduler –±–µ—Ä–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–¥–∞
6. –ø–æ–Ω–∏–º–∞–µ—Ç, –Ω–∞ –∫–∞–∫—É—é –Ω–æ–¥—É –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —ç—Ç–æ—Ç –ø–æ–¥
7. –∏ –¥–æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–∞ –∫—É—Å–æ–∫ –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ—Ç –ø–æ–¥ –¥.–±. –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Ç–∞–∫–æ–π-—Ç–æ –Ω–æ–¥–µ
8. –ø–æ—Å–ª–µ —á–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ api server.
9. Api server —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ etcd –∏ –≥–æ–≤–æ—Ä–∏—Ç scheduler'y "–≤—Å—ë —Ö–æ—Ä–æ—à–æ, —è –∑–∞–ø–∏—Å–∞–ª"

<aside>
‚ÄºÔ∏è Scheduler –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç. –ù–µ —Å–æ–∑–∞–µ—Ç –ø–æ–¥ –≤ k8s –∫–ª–∞—Å—Ç–µ—Ä–µ. –ù–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω–µ—Ä—ã –∏/–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
–û–Ω –ø—Ä–æ—Å—Ç–æ –Ω–µ–º–Ω–æ–∂–∫–æ –ø—Ä–æ–∞–ø–≥—Ä–µ–π–¥–∏–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —à–∞–±–ª–æ–Ω–∞—Ö –ø–æ–¥–∞ - –ø—Ä–æ–ø–∏—Å–∞–ª —Ç—É–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ—Ç –ø–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Ç–∞–∫–æ–π-—Ç–æ –Ω–æ–¥–µ. –ò —Å–æ—Ö—Ä–∞–Ω–∏–ª —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ api server'–µ.

</aside>

–ö–∞—Å–∞—Ç–µ–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ Scheduler'–æ–≤ - —Å–∏—Ç—É–∞—Ü–∏—è —Ä–æ–≤–Ω–æ —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –∏ —Å Controller Manager'–æ–º:
–ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–∏–Ω, –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–ª–∞—Å—Ç–µ—Ä —Å –æ–¥–Ω–∏–º scheduler'–æ–º –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.

–ù–æ –ø–æ —Ñ–∞–∫—Ç—É –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö –∑–∞–ø—É—Å–∫–∞—é 3 —à—Ç—É–∫–∏ - –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥–æ–π –º–∞—Å—Ç–µ—Ä –Ω–æ–¥–µ. –¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ Controller manager –µ—Å—Ç—å –ø–æ–Ω—è—Ç–∏–µ –º–∞—Å—Ç–µ—Ä–∞ - –≤ –∫–∞–∂–¥—ã–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—É –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω scheduler. –ï—Å–ª–∏ –º–∞—Å—Ç–µ—Ä –ø—Ä–æ–ø–∞–¥–∞–µ—Ç, –æ—Å—Ç–∞–≤—à–∏–µ—Å—è scheduler'—ã –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç –∑–∞ –ø—Ä–∞–≤–æ –±—ã—Ç—å –º–∞—Å—Ç–µ—Ä–æ–º. –¢–æ—Ç, —É –∫–æ–≥–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–∞—Å—Ç–µ—Ä–æ–º. –£ –∫–æ–≥–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –≤–∏—Å–∏—Ç –∏ –∂–¥–µ—Ç, –∫–æ–≥–¥–∞ –º–∞—Å—Ç–µ—Ä –ø—Ä–æ–ø–∞–¥–µ—Ç.

### Q&A

**Q:** –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω –º–∞—Å—Ç–µ—Ä, –∞ –≤—Ç–æ—Ä–æ–π –ø—Ä–æ—Å–Ω—É–≤—à–∏–π—Å—è —Ä–∞–Ω–µ–µ –±—ã–≤—à–∏–π –º–∞—Å—Ç–µ—Ä–æ–º - —É–∂–µ –Ω–µ –≤ —Å—Ç–∞—Ç—É—Å–µ –º–∞—Å—Ç–µ—Ä–∞, —Ç–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Ö–æ–ª–æ—Å—Ç—É—é?

**A:** –î–∞. –û–¥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—é—Ç –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –∂—Ä—É—Ç, –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä—è—Ç –≤ api server –∏ –∂–¥—É—Ç, –∫–æ–≥–¥–∞ –æ—Ç–≤–∞–ª–∏—Ç—Å—è –º–∞—Å—Ç–µ—Ä.

**Q:** –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω watch 

**A:** –≠—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö http2 - –Ω–∞ long polling –∏ —Ç.–¥.

<aside>
üìë **Etcd, Api Server, Controller manager –∏ scheduler** - —ç—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –∏–º–µ–Ω–Ω–æ –º–∞—Å—Ç–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏, —Ç.–µ. —Å—Ç–æ—è—Ç –Ω–∞ –º–∞—Å—Ç–µ—Ä –Ω–æ–¥–∞—Ö –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–±–æ—Ç—É –ø–æ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –≤—Å–µ–≥–æ –≥–ª–∞—Å—Ç–µ—Ä–∞.

</aside>

# [Worker –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](https://youtu.be/0rN_tUIZx7Y?t=2290)

–ù–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –∫–ª–∞—Å—Ç–µ—Ä–æ–º k8s, —É–ø—Ä–∞–≤–ª—è—é—Ç —Å–≤–æ–∏–º–∏ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –Ω–æ–¥–∞–º–∏

## [Kubelet](https://youtu.be/0rN_tUIZx7Y?t=2295)

- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∫–∞–∂–¥–æ–π –Ω–æ–¥–µ
–ü—Ä–∞–≤–¥–∞ –Ω–∞ 100% - —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–∞ –≤—Å–µ—Ö –Ω–æ–¥–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞: –∫–∞–∫ –Ω–∞ worker'–∞—Ö, —Ç–∞–∫ –∏ –Ω–∞ master –Ω–æ–¥–∞—Ö. Master-–Ω–æ–¥–∞ —Ä–æ–≤–Ω–æ —Ç–∞–∫–∞—è –∂–µ –Ω–æ–¥–∞ –∫–∞–ª—Å—Ç–µ—Ä–∞, –∫–∞–∫ –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ. –ï–¥–∏–Ω—Å—Ç—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –µ–µ –æ—Ç–ª–∏—á–∞–µ—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö –Ω–æ–¥ –∫–ª–∞—Å—Ç–µ—Ä–∞, —á—Ç–æ –æ–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ–±–æ–∑–Ω–∞—á–µ–Ω–∞ –∏ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º –ø–æ–¥–∞–º –∑–∞–ø—Ä–µ—â–µ–Ω–æ –Ω–∞ —ç—Ç–∏—Ö –Ω–æ–¥–∞—Ö –∑–∞–ø—É—Å–∫–∞—Ç—å. –•–æ—Ç—è —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ —Å–Ω—è—Ç—å.
- –û–±—ã—á–Ω–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–µ –≤ Docker.
–ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±—â–∞–µ—Ç—Å—è —Å docker'–æ–º –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∫–æ–Ω—Ç–µ–π–Ω–∏—Ä–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, kryo –∏ —Ç.–¥.). –û–±–º–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–æ–º, –∫–∞–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å, –∫–∞–∫–∏–µ –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏ —Ç.–¥. 
–†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ –∫–∞–∫ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ —Ö–æ—Å—Ç–µ.
- –û—Ç–¥–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã Docker daemon
–¢.–µ. –ø–æ —Ñ–∞–∫—Ç—É –æ–±—â–∞–µ—Ç—Å—è —Å docker daemon'–æ–º –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º api docker, —á—Ç–æ–±—ã –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏.
- –°–æ–∑–¥–∞–µ—Ç POD'—ã
- –í—ã–ø–ª–æ–Ω—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏: liveness, readiness and startup probes.
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—å, —á—Ç–æ kublet —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å —Ç–æ–π –∂–µ –Ω–æ–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–ø—É—â–µ–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è –ø–æ localhost) –∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞ –Ω–µ–≥–æ –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ —Å–∞–º–∞ –Ω–æ–¥–∞ –æ—Ç–≤–∞–ª–∏–ª–∞—Å—å –æ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞, –∏ kubelet –æ–± —ç—Ç–æ–º –Ω–µ —É–∑–Ω–∞–µ—Ç. –ù–æ –ø—Ä–∏ —ç—Ç–æ–º —Å–∞–º –∫–ª–∞—Å—Ç–µ—Ä k8s –ø–æ–π–º–µ—Ç, —á—Ç–æ –Ω–æ–¥–∞ –æ—Ç–≤–∞–ª–∏–ª–∞—Å—å –∏ —É–±–µ—Ä–µ—Ç –µ–µ –∏–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏.
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Api Server –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–µ–π –Ω–æ–¥–µ:
    - —è –∂–∏–≤, –º—ã —Å –º–æ–µ–π –Ω–æ–¥–æ–π –Ω–∞ –º–µ—Å—Ç–µ
    - —É –º–µ–Ω—è –∑–∞–ø—É—â–µ–Ω—ã —Ç–∞–∫–∏–µ-—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –≤ —Ç–∞–∫–æ–º-—Ç–æ —Å—Ç–∞—Ç—É—Å–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è
    - —Å–∫–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –Ω–æ–¥–µ –æ—Å—Ç–∞–ª–æ—Å—å, —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ –∑–∞–ø—Ä–æ—à–µ–Ω–æ, —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
    
    –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –¥–æ Controller manager –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –¥–æ—Ö–æ–¥–∏—Ç—å –≤—Å—è —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, Controller manager –ø–æ–º–µ—Ç–∏—Ç –≤—Å—é –Ω–æ–¥—É –∫–∞–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—É—é –∏ –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —ç—Ç–æ–π –Ω–æ–¥—ã –æ–Ω —Ç–∞–∫–∂–µ –ø–æ–º–µ—Ç–∏—Ç –∫–∞–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏ —É–±–µ—Ä–µ—Ç –∏—Ö –∏–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏, –≤—ã–∫–∏–Ω–µ—Ç –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –≤–µ–ª–∏ –Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–¥—ã. –ò, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—Å—è –Ω–∞ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–¥—ã –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.
    

### [–†–∞–±–æ—Ç–∞ kubelet –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ](https://youtu.be/0rN_tUIZx7Y?t=2595)

![005_kubelet.png](./assets/lesson_7/005_kubelet.png)

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ Scheduler –≤—ã–±—Ä–∞–ª –Ω–æ–¥—É –¥–ª—è –ø–æ–¥–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏–ª —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –ø–æ–¥–∞ –≤ –∏–≥—Ä—É –≤—Å—Ç—É–ø–∞–µ—Ç kubelet.

- kubelet (–∫–æ—Ç–æ—Ä—ã–π –≤–∏—Å–∏—Ç –Ω–∞ –∫–∞–∂–¥–æ–π –Ω–æ–¥–µ) —Å–º–æ—Ç—Ä–∏ –≤ api server –∏ –∂–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –Ω–∞ –µ–≥–æ –Ω–æ–¥—É –±—ã–ª –Ω–∞–∑–Ω–∞—á–µ–Ω –ø–æ–¥.
- —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–æ, kubelet —Ç–æ–π –Ω–æ–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é Scheduler –Ω–∞–∑–Ω–∞—á–∏–ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤–∏–¥–∏—Ç, —á—Ç–æ –ø–æ—è–≤–∏–ª–∞—Å—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏ –æ –ø–æ–¥–µ, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–º –Ω–∞ –µ–≥–æ –Ω–æ–¥—É, –Ω–æ —É –Ω–µ–≥–æ –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º
- kubelet –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–æ–∫–µ—Ä –æ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –æ–±—Ä–∞–∑ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–¥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Å–µ—Ç—å—é –∏ —Å–∞–º –ø—Ä–æ—Ü–µ—Å—Å.
- docker –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—é —Ä–∞–±–æ—Ç—É –ø–æ –∑–∞–ø—É—Å–∫—É, –æ –∫–æ—Ç–æ—Ä–æ–π –µ–≥–æ –ø–æ–ø—Ä–æ—Å–∏–ª kubelet, –∞ kubelet –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞—Ç—É—Å–µ –∫–æ—Ç–µ–π–Ω–µ—Ä–∞ –≤ api server.
- Api server —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å—é —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ etcd

<aside>
‚òù –ò–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–º –º–µ—Å—Ç–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
–¢.–µ. —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –æ –∑–∞–ø—É—Å–∫–µ –ø–æ–¥–∞ –¥–æ –µ–≥–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ü–µ–ª–∞—è —Ü–µ–ø–æ—á–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∫–æ–º–ø–æ–Ω—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ k8s –∫–ª–∞—Å—Ç–µ—Ä–∞.

</aside>

<aside>
‚òù K8s —Ç–∞–∫–∞—è —Å–∏—Å—Ç–µ–º–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∏–∫—Ç–æ –Ω–∏–∫–æ–º—É –Ω–µ –æ—Ç–¥–∞–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∞–Ω–¥.
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω—É–∂–Ω—ã–µ –∏–º —Å–æ–±—ã—Ç–∏—è, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å—Ç–æ –∏—Ö –ø–æ–ª—É—á–∞–µ—Ç, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
K–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ—Ç k8s –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ —Å–≤–æ–µ–π —á–∞—Å—Ç—å—é —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é —á–∞—Å—Ç—å –æ–±—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –¢.–µ. –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç —Å–≤–æ—é —á–∞—Å—Ç—å –æ–±—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫ –Ω—É–∂–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ api server. –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ—Ç—ã —Å–ª–µ–¥—è—Ç –∑–∞ —Å–≤–æ–µ–π —á–∞—Å—Ç—å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ api server'–µ.
–¢.–µ. api server —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–æ–π –ø—Ä–∞–≤–¥—ã.

</aside>

## [Kube-proxy](https://youtu.be/0rN_tUIZx7Y?t=3013)

kube-proxy - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π. 

–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç: kube-proxy –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –Ω–µ–ø–æ—Å—Ç—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π —Å–µ—Ç–∏ - —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (calico –∏ –ø—Ä–æ—á–µ–µ).

- –°–º–æ—Ç—Ä–∏—Ç –≤ Kube-API
- –°—Ç–æ–∏—Ç –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö (–≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ –Ω–∞ –º–∞—Å—Ç–µ—Ä –Ω–æ–¥–∞—Ö)
- –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–µ—Ç–µ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–∞ –Ω–æ–¥–∞—Ö
- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç Service (ipvs –∏ iptables)

# [To be continued ...](https://youtu.be/0rN_tUIZx7Y?t=3042)